---
layout: post
title: Java内存空间，即堆和栈的区别和使用
comments: true
author: "Yin Haomin"
tags:
    - Memory
    - Stack
    - Heap
---

本文来总结下Java中的内存空间的分配，堆和栈的区别，它们各自的作用，如何会导致相应的异常，以及解决异常的方式。<br>

Java运行时的数据区包括程序计数器，方法区，堆，虚拟机栈，本地方法栈。我们主要关心的是堆和栈，下面我们来分析下他们的区别。<br>

#### 1. 堆和栈的简单比较
|类型|是否共享|存放的数据|生命周期|抛出异常|Re|
|:-------|:-------|:-------|:-------|:-------|:-------|
|Stack|No|方法执行的局部变量，动态链接，方法出口|与线程周期相同|StackOverFlowError,OutOfMemoryError||
|Heap|Yes|---|与程序周期相同|OutOfMemoryError||

#### 2. 堆的详细描述



#### 3. 栈的详细描述
(1). 栈是跟随运行出来的，与线程的生命周期相同，不会涉及到内存的回收。<br>
(2). 栈帧是一个重要的概念，每一个Java方法的调用，都是栈帧进栈出栈的过程。<br>
![gras](/images/stackheap/JVM栈和栈帧.png)<br>
(3). 当在一个过程中，有大量的递归，导致栈中存储了大量的数据，直到不能再获取到新的内存空间，存储数据的时候，就会出现StackOverFlowError。<br>而当不断的新建新的线程，直至内存不够给栈分配的时候，会出现OutOfMmoryError<br>
(4). 当出现因为栈导致的内存OOM的时候，当线程的数量没有办法减少的时候，可以考虑减少最大堆和减小每个stack的大小。
